# 队列

任务的处理速度与线程个数并不是线性正相关。相反，过多的线程反而会导致 CPU 频繁切换，处理性能下降。

## 如何理解”队列“

先进先出

循环队列、阻塞队列、并发队列

高性能队列：Disruptor、Linux环形缓存都用到了循环并发队列；Java concurrent并发包利用ArrayBlockingQueue来实现公平锁

## 顺序队列和链式队列

### 顺序队列

注意：记录头部索引和队尾，当数据出队时不进行数据的搬移，只有当数据入队时检查是否超出空间大小，进行数据搬移。这样可以做到时间复杂度为O(1)而不是O(n)

### 链表队列

## 循环队列

我们用数组实现队列，在尾部超出时，会有数据搬移操作，此时就用到了循环队列

### 关键

确定好队空和队满的条件

|分类|非循环队列|循环队列|
|  ----  | ----  | --- |
|队空|head == tail|head == tail|
|队满|tail == n |(tail + 1) % n == head|
|空间|全部可用|通常会浪费一个数组的存储空间|

#### 为什么浪费一个数组的存储空间

为了更好的判断队满的条件

## 阻塞队列和并发队列

### 阻塞队列

生产者 - 消费者

### 并发队列

线程安全队列

## 思考

当我们向固定大小的线程池中请求一个线程时，如果线程池中没有空闲资源了，这个时候线程池如何处理这个请求？是拒绝请求还是排队请求？各种处理策略又是怎么实现的呢？

队列
